---

- name: "Output test results"
  block:
  - debug:
      msg: "SalesforceBundle: {{ SalesforceBundle | default({}) }}"
  - debug:
      msg: "IntegrationBundle: {{ IntegrationBundle | default({}) }}"

- name: "Wait for test results"
  debug:
    msg: "{{ SalesforceBundle | default('KO') | regex_search(exp) }}"
  vars:
    exp: "OK \\(\\d+ tests, \\d+ assertions\\)"
  until: IntegrationBundle is defined and SalesforceBundle is defined
  retries: 10
  delay: 10